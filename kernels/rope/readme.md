# Rope

## 说明

rope kernel

- [x] rope fp32 版 (比pytorch naive 实现快一个数量级)
- [x] pytorch op bindings && diff check

## 测试

```bash
export TORCH_CUDA_ARCH_LIST=$(nvidia-smi --query-gpu=compute_cap --format=csv,noheader | head -n 1)
python test.py
```

### 输出

```bash
####################################################################################################
n: 512, m: 128
torch                          mean time: 0.265313 ms
rope                           mean time: 0.015100 ms
####################################################################################################
n: 512, m: 256
torch                          mean time: 0.286578 ms
rope                           mean time: 0.010288 ms
####################################################################################################
n: 1024, m: 128
torch                          mean time: 0.234017 ms
rope                           mean time: 0.008303 ms
####################################################################################################
n: 1024, m: 256
torch                          mean time: 0.270973 ms
rope                           mean time: 0.011027 ms
####################################################################################################
n: 2048, m: 128
torch                          mean time: 0.375782 ms
rope                           mean time: 0.019841 ms
####################################################################################################
n: 2048, m: 256
torch                          mean time: 0.280690 ms
rope                           mean time: 0.011407 ms
####################################################################################################
n: 4096, m: 128
torch                          mean time: 0.265533 ms
rope                           mean time: 0.016615 ms
####################################################################################################
n: 4096, m: 256
torch                          mean time: 0.335155 ms
rope                           mean time: 0.014705 ms
```
