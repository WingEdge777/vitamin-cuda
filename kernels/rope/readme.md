# Rope

## 说明

rope kernel

- [x] rope fp32 版 (比pytorch naive 实现快一个数量级)
- [x] pytorch op bindings && diff check

## 测试

```bash
export TORCH_CUDA_ARCH_LIST=$(nvidia-smi --query-gpu=compute_cap --format=csv,noheader | head -n 1)
python test.py
```

### 输出

```bash
####################################################################################################
n: 512, m: 128
torch                          mean time: 0.304392 ms
rope                           mean time: 0.008391 ms
####################################################################################################
n: 512, m: 256
torch                          mean time: 0.348403 ms
rope                           mean time: 0.024918 ms
####################################################################################################
n: 1024, m: 128
torch                          mean time: 0.260193 ms
rope                           mean time: 0.012217 ms
####################################################################################################
n: 1024, m: 256
torch                          mean time: 0.310559 ms
rope                           mean time: 0.011769 ms
####################################################################################################
n: 2048, m: 128
torch                          mean time: 0.267656 ms
rope                           mean time: 0.019480 ms
####################################################################################################
n: 2048, m: 256
torch                          mean time: 0.311535 ms
rope                           mean time: 0.009670 ms
####################################################################################################
n: 4096, m: 128
torch                          mean time: 0.265947 ms
rope                           mean time: 0.016350 ms
####################################################################################################
n: 4096, m: 256
torch                          mean time: 0.314480 ms
rope                           mean time: 0.016479 ms
####################################################################################################
n: 8192, m: 128
torch                          mean time: 0.277222 ms
rope                           mean time: 0.013739 ms
####################################################################################################
n: 8192, m: 256
torch                          mean time: 0.495291 ms
rope                           mean time: 0.026006 ms
```
